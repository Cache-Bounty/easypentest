## easypentest : Test cases and scripts to make pentesting windows and linux applications easy.


## Linux :

### RPATH

Checking RPATH : 

 `objdump -p /binary | grep -i rpath`
 
 `readelf -a /binary | grep -i rpath`


Compiling with RPATH :

`gcc -Wl,-rpath=/binary program.c`


Removing RPATH :

`patchelf --remove-rpath /binary`


Changing RPATH :

`patchelf --force-rpath --set-rpath "New-Rpath" /binary`

`chrpath -r 'New-Rpath' /binary `

### Stack Canary

Compiling with Stack Canary :
`gcc tmp.c -fstack-protector-all`

Checking if Stack Canary is enforced :
`readelf -s a.out | grep -i stack_chk`

Demo :
```
[root@clm-pun-tt7ctg checksec.sh]# gcc tmp.c -fstack-protector-all

[root@clm-pun-tt7ctg checksec.sh]# readelf -s a.out | grep -i stack_chk
     1: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __stack_chk_fail@GLIBC_2.4 (2)
    50: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __stack_chk_fail@@GLIBC_2
 ```   
Compiling without Stack Canary :
```
[root@clm-pun-tt7ctg checksec.sh]# gcc tmp.c

[root@clm-pun-tt7ctg checksec.sh]# readelf -s a.out | grep -i stack_chk
```
`Note : No output returned. By default gcc does not enforce stack canaries.`


### Symbols (linker symbols)
https://stackoverflow.com/questions/2577068/what-is-symbol-table-and-how-is-it-integrated-into-the-executable


Checking if symbols are present :
`readelf --symbols a.out | grep -i symtab`
`file a.out | grep -i "not stripped"`


Demo :
```
[root@clm-pun-tt7ctg checksec.sh]# gcc tmp.c
[root@clm-pun-tt7ctg checksec.sh]# readelf --symbols a.out | grep -i symtab
Symbol table '.symtab' contains 65 entries:
[root@clm-pun-tt7ctg checksec.sh]# file a.out
a.out: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, BuildID[sha1]=be5bf11b01830b497087943a285d6f4e3f74a24e, not stripped
```

Removing symbols from compiled binary:
`strip a.out`

Demo :
```
[root@clm-pun-tt7ctg checksec.sh]# strip a.out
[root@clm-pun-tt7ctg checksec.sh]# readelf --symbols a.out | grep -i symtab
[root@clm-pun-tt7ctg checksec.sh]# file a.out | grep -i "not stripped"
```

Compiling without symbols :
`gcc -s tmp.c`

Demo :
```
[root@clm-pun-tt7ctg checksec.sh]# gcc -s tmp.c
[root@clm-pun-tt7ctg checksec.sh]# readelf --symbols a.out | grep -i symtab
[root@clm-pun-tt7ctg checksec.sh]# file a.out | grep -i "not stripped"
```


### Symbols (debug symbols)
https://stackoverflow.com/questions/2577068/what-is-symbol-table-and-how-is-it-integrated-into-the-executable

`TODO`








