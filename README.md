## easypentest : Test cases and scripts to make pentesting windows and linux applications easy.


## Linux :

### RPATH

Checking RPATH : 

 `objdump -p /binary | grep -i rpath`
 
 `readelf -a /binary | grep -i rpath`


Compiling with RPATH :

`gcc -Wl,-rpath=/binary program.c`


Removing RPATH :

`patchelf --remove-rpath /binary`


Changing RPATH :

`patchelf --force-rpath --set-rpath "New-Rpath" /binary`

`chrpath -r 'New-Rpath' /binary `

### Stack Canary

Compiling with Stack Canary :
`gcc tmp.c -fstack-protector-all`

Checking if Stack Canary is enforced :
`readelf -s a.out | grep -i stack_chk`

Demo :
```
[root@clm-pun-tt7ctg checksec.sh]# gcc tmp.c -fstack-protector-all

[root@clm-pun-tt7ctg checksec.sh]# readelf -s a.out | grep -i stack_chk
     1: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __stack_chk_fail@GLIBC_2.4 (2)
    50: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __stack_chk_fail@@GLIBC_2
 ```   
Compiling without Stack Canary :
```
[root@clm-pun-tt7ctg checksec.sh]# gcc tmp.c

[root@clm-pun-tt7ctg checksec.sh]# readelf -s a.out | grep -i stack_chk
```
`Note : No output returned. By default gcc does not enforce stack canaries.`
